<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Analyzing the Results</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d8449d71" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=039e1c02" />
    <link rel="stylesheet" type="text/css" href="../_static/omnetpp.css?v=4fe950e8" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="NED Documentation Generator" href="neddoc.html" />
    <link rel="prev" title="Sequence Charts" href="sequence-chart.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
          

          <div class="body" role="main">
            
  <section id="analyzing-the-results">
<h1>Analyzing the Results</h1>
<section id="overview">
<h2>Overview</h2>
<p>Analyzing simulation results is crucial for validating models and understanding
their behavior. The Analysis Tool in the IDE is an editor that edits an
analysis (.anf) file. The analysis file captures the set of inputs and the
processing steps necessary for creating the desired plots and tables.</p>
<p>In OMNeT++, the results of simulations are captured as scalar values, vector
values, statistic summaries (hereafter just “statistics”), and histograms, and
are recorded into result files. Result files are tagged with metadata like the network name,
iteration variables, and configuration settings. The analysis typically begins
with the user specifying a set of result files either directly by name or
through patterns that match multiple files. Once loaded, these results can be
explored through an intuitive interface where users can browse, filter,
transform, and visualize data using various chart types.</p>
<p>Charts can be opened from the selected data with a few clicks. Charts use
queries in the form of filter expressions to select the desired subset of
results. Users can refine these expressions or write new ones to tailor the data
being visualized. The plotting capabilities range from using Matplotlib for
complex visualizations to employing the IDE’s own Native Plots for more
straightforward, interactive displays. Each chart allows adjustments such as
labels, colors, line styles, and other visual properties through a configuration
dialog.</p>
<p>The charts and their associated settings are remembered as part of the analysis
(.anf) file. When the user re-runs the simulations due to modifications in
simulation configurations or model adjustments and a new set of result files is
created, the analysis tool can automatically fill or refresh the charts with new
data.</p>
<p>Each chart in the analysis tool is backed by a customizable Python script and a
set of properties that can be edited through a chart configuration dialog. The
IDE allows users to edit the chart script to fit their precise needs, to add or
modify properties, and even update the configuration dialog to accommodate
additional inputs.</p>
<p>Finally, the analysis results can be reproduced and utilized outside the IDE
through <code class="docutils literal notranslate"><span class="pre">opp_charttool</span></code>, a command-line tool that recreates chart
views from the analysis files. This capability facilitates the integration of
results into batch processes, such as compiling LaTeX articles, or sharing them
for independent review. Detailed information on this tool and its
functionalities is provided in the Simulation Manual, offering a comprehensive
framework for managing simulation outputs.</p>
</section>
<section id="creating-analysis-files">
<span id="ana-creating-anf-files"></span><h2>Creating Analysis Files</h2>
<p>The usual way of creating an analysis file is to “imitate” opening an OMNeT++
result file (<code class="docutils literal notranslate"><span class="pre">.sca</span></code> or <code class="docutils literal notranslate"><span class="pre">.vec</span></code>) by double-clicking it in the
<span class="guilabel">Project Explorer</span> view. Result files cannot be opened directly, so
the IDE will offer creating an analysis file for it instead.</p>
<p>If the result file name looks like the file was created as part of an experiment
or parameter study, the IDE creates an analysis file that includes all result
files from that experiment as input. In the resulting inputs, the variable part of
the file name will be replaced by an asterisk (<code class="docutils literal notranslate"><span class="pre">*</span></code>), and an input will be
added with both the <code class="docutils literal notranslate"><span class="pre">.sca</span></code> and <code class="docutils literal notranslate"><span class="pre">.vec</span></code> file extensions. For example,
double-clicking a file called <code class="docutils literal notranslate"><span class="pre">PureAloha-numHosts=10,iaMean=1-#3.sca</span></code>
will add <code class="docutils literal notranslate"><span class="pre">PureAloha-*.sca</span></code> and <code class="docutils literal notranslate"><span class="pre">PureAloha-*.vec</span></code> to the analysis.</p>
<p>Upon double-clicking, the <span class="guilabel">New Analysis File</span> dialog will open. The
folder and the file name are pre-filled according to the location and name of
the result file. Press Finish to create the new analysis file.</p>
<p>The same dialog is also available from the menu as <span class="menuselection">File ‣ New
‣ Analysis File</span>. However, analysis files created that way will contain no
reference to result files, so file name patterns will need to be added later.</p>
<figure class="align-default" id="id2">
<a class="reference internal image-reference" href="../_images/ANF-NewAnalysisFileDialog.png"><img alt="../_images/ANF-NewAnalysisFileDialog.png" src="../_images/ANF-NewAnalysisFileDialog.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 118 </span><span class="caption-text">New Analysis File dialog</span></p>
</figcaption>
</figure>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If the analysis file already exists, double-clicking on the result
file will open it.</p>
</div>
</section>
<section id="opening-older-analysis-files">
<span id="ana-opening-older-anf-files"></span><h2>Opening Older Analysis Files</h2>
<p>The format of the analysis files (<code class="docutils literal notranslate"><span class="pre">*.anf</span></code>) has changed in OMNeT++ 6.0 in a
non-backward compatible way, meaning that older OMNeT++ versions will not be
able to open new analysis files. OMNeT++ 6.0, however, attempts to open and
convert analysis files created by older versions. Keep in mind that the
conversion is a “best-effort” attempt: the result may be incomplete or incorrect.
Always check that the converted charts indeed correspond to the original ones, and
refine the result if needed.</p>
</section>
<section id="using-the-analysis-editor">
<span id="ana-using-analysis-editor"></span><h2>Using the Analysis Editor</h2>
<p>The usual workflow of result analysis consists of a few distinct steps.
These are: adding input files to the analysis, browsing simulation results,
and selecting those of interest, creating a chart of an appropriate type from
the results, then viewing them as plots, and finally exporting data and/or
images if needed.</p>
<p>The Analysis Editor is implemented as a multi-page editor. What the editor
edits is the “recipe”: what result files to take as inputs, and what kind of
charts to create from them. The pages (tabs on the bottom) of the editor
roughly correspond to some of the steps described above.</p>
<p>In the next sections, we will go through the individual pages of the editor
and which analysis steps can be performed using them.</p>
</section>
<section id="the-inputs-page">
<span id="ana-inputs-page"></span><h2>The Inputs Page</h2>
<p>The first page in the editor is the <span class="guilabel">Inputs</span> page, where you specify
input files for analysis. You can add a set of file name patterns that specify
which result files to load. When the IDE expands the patterns, it displays the
list of matched files under each one. The contents of files are also displayed
in a tree structure.</p>
<figure class="align-default" id="id3">
<img alt="../_images/ANF-InputsPage.png" src="../_images/ANF-InputsPage.png" />
<figcaption>
<p><span class="caption-number">Fig. 119 </span><span class="caption-text">The <span class="guilabel">Inputs</span> page</span></p>
</figcaption>
</figure>
<p>New input files can be added to the analysis by dragging vector and scalar files
from the <span class="guilabel">Project Explorer</span> view, or by opening a dialog with the
<span class="guilabel">New Input</span> button on the local toolbar.</p>
<section id="resolution-rules">
<h3>Resolution Rules</h3>
<p>Input file patterns are resolved with the following rules:</p>
<ol class="arabic simple">
<li><p>An asterisk (<code class="docutils literal notranslate"><span class="pre">*</span></code>) matches files/folders within a single folder.</p></li>
<li><p>A double asterisk (<code class="docutils literal notranslate"><span class="pre">**</span></code>) may match multiple levels in the folder hierarchy.</p></li>
<li><p>If the pattern starts with a slash (<code class="docutils literal notranslate"><span class="pre">/</span></code>), it is understood as a workspace full path,
with its first component being a project name.</p></li>
<li><p>If the pattern does not start with a slash (<code class="docutils literal notranslate"><span class="pre">/</span></code>), it is interpreted as
relative to the folder of the analysis file.</p></li>
<li><p>If the pattern identifies a folder, it will match all result files in it
(i.e. <code class="docutils literal notranslate"><span class="pre">/foo/results</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">/foo/results/**.sca</span></code> plus
<code class="docutils literal notranslate"><span class="pre">/foo/results/**.vec</span></code>).</p></li>
</ol>
</section>
<section id="refresh-files">
<h3>Refresh Files</h3>
<p>The input files are loaded when the analysis file is opened.</p>
<p>If files change on the disk or new files are created while the analysis is open
(for example, because a simulation was re-run), a refresh can be triggered with the
<span class="guilabel">Refresh Files</span> button on the toolbar. <span class="guilabel">Refresh Files</span> expands
the file name patterns again, then loads any new matching files, unloads files
that no longer exist on the disk, and reloads the files that have changed
since being loaded. Open charts are also refreshed.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the design of the Analysis Tool, it was a conscious choice to opt for
explicit reload in favor of an automatic one. Automatic reload would make it
difficult to look at partial results due to excessive refreshing while a large
simulation campaign is underway, or when a simulation is continually writing
into a loaded vector file.</p>
</div>
</section>
<section id="reload-files">
<h3>Reload Files</h3>
<p>It is also possible to let the Analysis Tool completely forget all loaded result files,
and have them reloaded from scratch. The functionality is available from the
context menu as <span class="guilabel">Reload All Files</span>.</p>
</section>
<section id="are-files-kept-in-memory">
<h3>Are Files Kept in Memory?</h3>
<p>The contents of scalar files <em>are</em> loaded in memory.</p>
<p>Vector files are not loaded directly; instead, a much smaller index file
(<code class="docutils literal notranslate"><span class="pre">*.vci</span></code>) is created and the vector attributes (name, module, run, statistics,
etc.) are loaded from the index file. The index files are generated during the
simulation, but can be safely deleted without loss of information. If the index
file is missing or the vector file was modified, the IDE rebuilds the index in
the background.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The <span class="guilabel">Progress</span> view displays the progress of the
indexing process if it takes a long time.</p>
</div>
</section>
</section>
<section id="the-browse-data-page">
<span id="ana-browse-data-page"></span><h2>The Browse Data Page</h2>
<p>The second page of the Analysis editor displays results (parameters,
scalars, histograms, and vectors) from all files in tables and lets the
user browse them. Results can be sorted and filtered. Simple filtering
is possible with combo boxes, or when that is not enough, the user can
write arbitrarily complex filters using a generic pattern-matching
expression language. Selected or filtered data can be immediately
plotted.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can switch between the <span class="guilabel">All</span>, <span class="guilabel">Parameters</span>,
<span class="guilabel">Scalars</span>, <span class="guilabel">Histograms</span>, and <span class="guilabel">Vectors</span>
pages using the underlined shortcuts (<kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Alt</kbd>+<kbd class="kbd docutils literal notranslate">letter</kbd></kbd> combination) or the
<kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Ctrl</kbd>+<kbd class="kbd docutils literal notranslate">PgUp</kbd></kbd> and <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Ctrl</kbd>+<kbd class="kbd docutils literal notranslate">PgDown</kbd></kbd> keys.</p>
</div>
<figure class="align-default" id="id4">
<img alt="../_images/ANF-BrowseDataPageAll.png" src="../_images/ANF-BrowseDataPageAll.png" />
<figcaption>
<p><span class="caption-number">Fig. 120 </span><span class="caption-text">Browsing all data generated by the simulation</span></p>
</figcaption>
</figure>
<p>The <span class="guilabel">All</span> tab shows a tree containing all loaded result items.
The structure of this tree can be altered with the <span class="guilabel">Tree Levels</span>
and <span class="guilabel">Flat Module Tree</span> options on the local toolbar and in the
context menu.</p>
<p>The other tabs show tables containing the values and attributes of
all results of the given type. To hide or show table columns, open
<span class="guilabel">Choose table columns</span> from the context menu and select
the columns to be displayed. The settings are persistent and applied
in each subsequently opened editor. The table rows can be sorted by
clicking on the column name.</p>
<figure class="align-default" id="id5">
<img alt="../_images/ANF-BrowseDataPageTable.png" src="../_images/ANF-BrowseDataPageTable.png" />
<figcaption>
<p><span class="caption-number">Fig. 121 </span><span class="caption-text">Browsing a subset of result items selected using a filter expression</span></p>
</figcaption>
</figure>
<p>Individual fields of composite results (e.g. the <cite>:mean</cite> and <cite>:count</cite> fields
of statistics, histograms, or vectors) can also be included as scalars by
enabling the <span class="guilabel">Show Statistics/Vector Fields as Scalars</span> option.</p>
<section id="filtering">
<h3>Filtering</h3>
<p>Filtering of the table contents is possible with the combo boxes above the
tables. The strings in the combo boxes may contain wildcards, and the combo
boxes also support content assist (<kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Ctrl</kbd>+<kbd class="kbd docutils literal notranslate">SPACE</kbd></kbd>), both of which are useful if
there are a huge number of items with different names.</p>
<p>If a more sophisticated selection criteria is needed, it is possible to switch
to a more generic filter expression. After pressing the <span class="guilabel">Filter
Expression</span> button in the filter row, you can enter an arbitrary filter
expression. The expression language is described in section
<a class="reference internal" href="#ana-filter-expression"><span class="std std-ref">Filter Expressions</span></a>.</p>
</section>
<section id="plotting">
<h3>Plotting</h3>
<p>You can display the selected data items on a chart. To open the chart, choose
one of the <span class="guilabel">Plot</span> items from the context menu, or press Enter
(double-click also works for single data lines). See section
<a class="reference internal" href="#ana-basic-chart-usage"><span class="std std-ref">Basic Chart Usage</span></a> for more information.</p>
</section>
<section id="viewing-the-details-of-result-items">
<h3>Viewing the Details of Result Items</h3>
<p>To see the properties of the selected result item, open the
<span class="guilabel">Properties</span> view. This is useful for checking properties that are not
displayed in the table, such as result attributes (<code class="docutils literal notranslate"><span class="pre">title</span></code>, <code class="docutils literal notranslate"><span class="pre">unit</span></code>,
<code class="docutils literal notranslate"><span class="pre">interpolationmode</span></code>, etc.), or the full list of bins of a histogram.</p>
</section>
<section id="viewing-the-contents-of-a-vector">
<h3>Viewing the Contents of a Vector</h3>
<p>When selecting a vector, its data can also be displayed in a table.
Make sure that the <span class="guilabel">Output Vector</span> view is opened. If it is
not open, you can open it from the context menu (<span class="guilabel">Show Output
Vector View</span>). This view always shows the contents of the selected vector.</p>
<figure class="align-default" id="id6">
<a class="reference internal image-reference" href="../_images/ANF-OutputVectorView.png"><img alt="../_images/ANF-OutputVectorView.png" src="../_images/ANF-OutputVectorView.png" style="width: 60%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 122 </span><span class="caption-text">The Output Vector View With its Context Menu</span></p>
</figcaption>
</figure>
</section>
<section id="exporting-data">
<h3>Exporting Data</h3>
<p>Selected results can be exported to files in different data formats
using the <span class="guilabel">Export Data</span> context menu option. After selecting
the data format, a dialog to select the output file and configure additional
exporting options is shown.</p>
<p>A variety of formats is available, including two CSV-based ones (CSV-R for
programmatic consumption and CSV-S for loading into spreadsheets), SQLite,
JSON, and so on. Vectors can be also cropped to a time interval in the export.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can switch between the <span class="guilabel">Inputs</span>, <span class="guilabel">Browse Data</span>, and
<span class="guilabel">Charts</span> pages using the <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Alt</kbd>+<kbd class="kbd docutils literal notranslate">PgUp</kbd></kbd> and <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Alt</kbd>+<kbd class="kbd docutils literal notranslate">PgDown</kbd></kbd>
keys.</p>
</div>
</section>
</section>
<section id="the-charts-page">
<span id="ana-charts-page"></span><h2>The Charts Page</h2>
<p>The third page displays the charts created during the analysis.</p>
<p>This page works much like a usual graphical file manager. Each icon
represents a chart, and the charts can be selected, reordered by dragging,
copied, pasted, renamed, deleted, opened, or their context menu accessed.
Different view modes like “icon” and “list” module can be selected.</p>
<p>The <span class="guilabel">Charts</span> page also enables you to organize your charts into
“folders,” providing a more structured and accessible view. This is especially
useful when managing a large number of charts.</p>
<figure class="align-default" id="id7">
<a class="reference internal image-reference" href="../_images/ANF-ChartsPage.png"><img alt="../_images/ANF-ChartsPage.png" src="../_images/ANF-ChartsPage.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 123 </span><span class="caption-text">Charts Page</span></p>
</figcaption>
</figure>
</section>
<section id="the-outline-view">
<span id="ana-outline-view"></span><h2>The Outline View</h2>
<p>The <span class="guilabel">Outline</span> view shows an overview of the current analysis. Clicking
on an element will select the corresponding element in the editor.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you select a chart that is currently open, the editor will switch to its
page in the editor instead of selecting it in the <span class="guilabel">Charts</span> page. If
there are many charts open, this can actually be a more convenient way of
switching between them than using the tabs at the bottom of the editor window.</p>
</div>
<figure class="align-default" id="id8">
<a class="reference internal image-reference" href="../_images/ANF-OutlineView.png"><img alt="../_images/ANF-OutlineView.png" src="../_images/ANF-OutlineView.png" style="width: 60%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 124 </span><span class="caption-text">Outline View of the analysis</span></p>
</figcaption>
</figure>
</section>
<section id="basic-chart-usage">
<span id="ana-basic-chart-usage"></span><h2>Basic Chart Usage</h2>
<p>This section introduces you to the basics of working with charts in the
OMNeT++ IDE. It shows how to navigate plots, configure their
appearance, and export data and images.</p>
<p>Charts can be created in two ways: first, based on the set of selected results
on the <span class="guilabel">Browse Data</span> page, and second, choosing from the list of
available chart types on the <span class="guilabel">Charts</span> page.</p>
<section id="plotting-data">
<span id="ana-plotting-results"></span><h3>Plotting Data</h3>
<p>Most often, a new chart is created from a set of simulation results displayed on
the <span class="guilabel">Browse Data</span> page.</p>
<p>To visualize data, first identify the set of simulation results you wish to
plot. By double-clicking on a result item or selecting multiple results and
pressing <kbd class="kbd docutils literal notranslate">Enter</kbd>, the editor will automatically open an appropriate chart.
Alternatively, you can right-click on the selected results to access a context
menu that offers a selection of chart templates compatible with the chosen data.</p>
<p>For a more detailed view, select the <span class="guilabel">Choose from Template Gallery</span>
context menu option. This displays a curated list of templates – filtered to
only show those suitable for your data – in the gallery dialog. Here, each
template is accompanied by a description and screenshots, providing a
comprehensive preview.</p>
<figure class="align-default" id="id9">
<a class="reference internal image-reference" href="../_images/ANF-PlotResults.png"><img alt="../_images/ANF-PlotResults.png" src="../_images/ANF-PlotResults.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 125 </span><span class="caption-text">Plotting the selected results</span></p>
</figcaption>
</figure>
<p>Charts opened this way are <cite>temporary charts</cite>, designed to allow users the
flexibility to explore simulation results and their various visualizations
without permanent commitment. If you find a chart that provides valuable
insights and wish to keep it for ongoing analysis, you can preserve it by
selecting <span class="guilabel">Save Chart</span> from the toolbar or the context menu of the
chart’s page. Once saved, the chart will then be listed on the
<span class="guilabel">Charts</span> page, making it a permanent part of your analysis.</p>
<p>If you have many charts open, it is easy to lose track of which ones have already
been saved into the analysis. To identify if an open chart is temporary, look
for the <span class="guilabel">Save Chart</span> icon on the leftmost part of the local toolbar.
This icon indicates that the chart is temporary. Conversely, if you see the
<span class="guilabel">Go To Chart Definition</span> icon, the chart has been saved as part of your
analysis. Clicking this button will direct you to the <span class="guilabel">Charts</span> page,
where the saved chart is displayed.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>After saving a temporary chart, it is recommended that you check the filter
expression on the <span class="guilabel">Inputs</span> page of the chart configuration dialog, and
refine or simplify it as needed. When the temporary chart is created, the IDE
generates a filter expression based on the selection, but the generated
expression is not always optimal, and it may not accurately express your
intended selection criteria.</p>
</div>
</section>
<section id="starting-from-a-blank-chart">
<h3>Starting From a Blank Chart</h3>
<p>On the <span class="guilabel">Charts</span> page, you can create a new chart by right-clicking in
an empty area and selecting a chart template from the <span class="guilabel">New</span> submenu.
Simply clicking on an item from this list will create a new chart based on
it.</p>
<p>Alternatively, use the <span class="guilabel">New Chart</span> button on the toolbar to open a
gallery-like dialog that provides detailed information, including a short
description and screenshots, for each chart template. By selecting a template
and pressing <span class="guilabel">OK</span>, you will instantiate that template into a new chart.</p>
<p>Charts created using either method will initially be empty, as they have not yet
been configured with a result selection filter expression.</p>
<figure class="align-default" id="id10">
<a class="reference internal image-reference" href="../_images/ANF-ChartTemplateGallery.png"><img alt="../_images/ANF-ChartTemplateGallery.png" src="../_images/ANF-ChartTemplateGallery.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 126 </span><span class="caption-text">The chart template gallery dialog</span></p>
</figcaption>
</figure>
</section>
<section id="opening-an-existing-chart">
<h3>Opening an Existing Chart</h3>
<p>To open an existing chart, double-click it in the <span class="guilabel">Charts</span> page, or
select it and hit <kbd class="kbd docutils literal notranslate">Enter</kbd>.</p>
</section>
<section id="plot-navigation">
<h3>Plot Navigation</h3>
<p>This section outlines the mouse and keyboard bindings for navigating two types
of plots in the Analysis Tool: native plots and Matplotlib-based plots.</p>
<ul class="simple">
<li><p><strong>Native Plots</strong>: These plots support two main modes: Pan mode and Zoom
mode. In Pan mode, you can scroll with the mouse wheel and drag the chart. In
Zoom mode, the user can zoom in on the chart by left-clicking and zoom out by
doing a <kbd class="kbd docutils literal notranslate">Shift</kbd> plus left-click or using the mouse wheel. Dragging
selects a rectangular area for zooming. The toolbar icons switch between
Pan and Zoom modes. You can also find toolbar buttons to zoom in, zoom out, and
zoom to fit. Zooming and moving actions are remembered in the navigation
history.</p></li>
<li><p><strong>Matplotlib plots</strong>: Navigation in Matplotlib plots generally follows
standard Matplotlib interactions but includes a few enhancements for better
control. One addition is the following: the mouse wheel, <kbd class="kbd docutils literal notranslate">Shift</kbd> plus mouse wheel, and
<kbd class="kbd docutils literal notranslate">Ctrl</kbd> plus mouse wheel pans vertically / horizontally or zooms. There is
also a third mode, called Interactive mode, which is used to manipulate
interactive elements on the plot, such as widgets, if present.</p></li>
</ul>
</section>
<section id="the-chart-properties-dialog">
<h3>The Chart Properties Dialog</h3>
<p>Charts have a set of properties that define their behavior and appearance.
These properties can be edited in a configuration dialog, accessible
from the <span class="guilabel">Configure Chart</span> toolbar button and context menu item.</p>
<p>The dialog has a tabbed layout, where the list of tabs and the form on each page
differ for each chart type. Pages that are common to nearly all chart types
(albeit with slightly differing contents) are:</p>
<ul class="simple">
<li><p><span class="guilabel">Input</span>: Defines which simulation results should be used
as input for the chart and their roles (e.g., which ones to use for the
horizontal axis, iso lines, etc.).</p></li>
<li><p><span class="guilabel">Plot</span>, <span class="guilabel">Lines</span>, <span class="guilabel">Bars</span>, etc.: For configuring the labels, markers, ticks, grid, etc.</p></li>
<li><p><span class="guilabel">Styling</span>: Visual properties for the plot.</p></li>
<li><p><span class="guilabel">Advanced</span>: Lets you manually add plot properties that are not configurable on the other pages.</p></li>
<li><p><span class="guilabel">Export</span>: Properties to be used during image/data export.</p></li>
</ul>
<figure class="align-default" id="id11">
<a class="reference internal image-reference" href="../_images/ANF-ChartPropertiesDialog.png"><img alt="../_images/ANF-ChartPropertiesDialog.png" src="../_images/ANF-ChartPropertiesDialog.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 127 </span><span class="caption-text">The Chart Properties Dialog</span></p>
</figcaption>
</figure>
<p>For many input fields, autocompletion and smart suggestions are available
by pressing <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Ctrl</kbd>+<kbd class="kbd docutils literal notranslate">SPACE</kbd></kbd>.</p>
</section>
<section id="id1">
<h3>Exporting Data</h3>
<p>Both the input data used by a chart and the final result after processing
can be exported.</p>
<p>The first one is essentially the same as the result exporting option on the
<span class="guilabel">Browse Data</span> page, except that it uses the result filter expression
of the given chart to select which results to export. This is available under the
<span class="guilabel">Export Chart Input As</span> context menu item of charts.</p>
<p>The second one is available under the common <span class="guilabel">Export Chart</span>
option, as discussed in section <a class="reference internal" href="#ana-batch-export"><span class="std std-ref">Batch Export</span></a>.</p>
</section>
<section id="exporting-images">
<h3>Exporting Images</h3>
<p>There are multiple, significantly different ways of exporting a chart to an image:</p>
<ul class="simple">
<li><p>You can copy the chart to the clipboard by selecting <span class="guilabel">Copy to
Clipboard</span> from the context menu. The chart is copied as a bitmap image the
same size as the chart on the screen, taking the current navigation state into
account.</p></li>
<li><p>The <span class="guilabel">Save Image</span> option saves the currently shown part of the chart
to an image file. Popular raster and vector formats are accepted, including
PNG, JPG, SVG, GIF, TIFF, etc.</p></li>
<li><p>Finally, the <span class="guilabel">Export Chart</span> option opens the combined
image/data exporting dialog (see section <a class="reference internal" href="#ana-batch-export"><span class="std std-ref">Batch Export</span></a>) for this
chart only. This option relies on the chart script for doing the actual
exporting.</p></li>
</ul>
</section>
<section id="batch-export">
<span id="ana-batch-export"></span><h3>Batch Export</h3>
<p>When exporting multiple charts or when selecting the <span class="guilabel">Export Chart</span>
option for a single chart, a common export dialog is opened.</p>
<figure class="align-default" id="id12">
<a class="reference internal image-reference" href="../_images/ANF-ExportCharts.png"><img alt="../_images/ANF-ExportCharts.png" src="../_images/ANF-ExportCharts.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 128 </span><span class="caption-text">Export Charts Dialog</span></p>
</figcaption>
</figure>
<p>Individual file names and image dimensions can be specified for each chart in their
respective chart configuration dialog.</p>
<p>Note that native charts exported this way will be emulated with Matplotlib, so
the saved images may look a bit different than in the IDE.</p>
<p>This is also the way <code class="docutils literal notranslate"><span class="pre">opp_charttool</span></code> exports charts from the command line.</p>
</section>
</section>
<section id="configuring-charts">
<span id="ana-configuring-charts"></span><h2>Configuring Charts</h2>
<p>This section discusses working with charts in more detail.</p>
<section id="available-chart-types">
<h3>Available Chart Types</h3>
<p>The Analysis Tool offers two distinct methods for displaying plots:</p>
<ul class="simple">
<li><p><strong>Matplotlib:</strong> Utilizes the full functionality of Matplotlib within the IDE,
allowing for the creation of virtually any type of plot.</p></li>
<li><p><strong>Native Plots:</strong> Although limited to bar, line, and histogram plots,
these widgets are more responsive and scalable compared to Matplotlib.</p></li>
</ul>
<p>Chart templates can be categorized according to whether they use native plot
widgets for displaying the plot or Matplotlib. It is usually indicated in the
name of a chart type whether it is Matplotlib-based or uses a native plot.</p>
<p>There are a number of chart templates in the library of the Analysis Tool. We
list the most frequently used ones below.</p>
<p>Based on Native Plots:</p>
<ul class="simple">
<li><p><strong>Line Chart:</strong> Plots vector results as line charts, with the native plot widget.
The default interpolation mode is determined automatically from the result
attributes. Many kinds of vector operations (smoothing, accumulating,
mathematical formulas, etc.) can be easily performed on the vector data.
Interpolation, markers, and line style can be configured. Hovering over legend
entries with the mouse highlights the corresponding series, clicking on the
labels hides/shows the series.</p></li>
<li><p><strong>Scatter Chart (Scalars in the Function of Itervars):</strong> Displays scalar results
on scatter plots, using the native plot widget. X-axis values are taken
from a numeric iteration variable. Optionally, results can be grouped into
series by iteration variables, run attributes, or result attributes. Markers
and line style can be configured. Hovering over legend entries with the mouse
highlights the corresponding points/iso line, clicking on the labels
hides/shows the points/iso line.</p></li>
<li><p><strong>Bar Chart:</strong> Plots scalar results as a bar chart, with the native plot widget.
The bars can optionally be grouped. Individual bars in each group can be
stacked, or positioned in different ways. Hovering over legend entries with
the mouse highlights the corresponding data series, clicking on the labels
hides/shows the series.</p></li>
<li><p><strong>Histogram Chart:</strong> Plots histogram results with the native plot widget. The
drawing style can be filled or outline. Transformations to cumulative and
normalized forms are available. Hovering over legend entries with the mouse
highlights the corresponding histogram, clicking on the labels hides/shows the
histogram.</p></li>
<li><p><strong>Histogram from Vectors Chart:</strong> Plots histograms from vector results with the
native plot widget. The drawing style can be filled or outline. Transformations
to cumulative and normalized forms are available. Hovering over legend entries
with the mouse highlights the corresponding histogram, clicking on the labels
hides/shows the histogram.</p></li>
</ul>
<p>Their Matplotlib equivalents:</p>
<ul class="simple">
<li><p><strong>Line Chart with Matplotlib:</strong> Plots vector results as line charts, with
Matplotlib. The default interpolation mode is determined automatically from
the result attributes. Many kinds of vector operations (smoothing,
accumulating, mathematical formulas, etc.) can be easily performed on the
vector data. Interpolation, markers, and line style can be configured.</p></li>
<li><p><strong>Scatter Chart with Matplotlib (Scalar in the Function of Itervars):</strong> Plots scalar
results as scatter charts, using Matplotlib, with the X-axis values taken from
a numeric iteration variable. Optionally, results can be grouped into series
by iteration variables, run attributes, or result attributes. Markers and line
style can be configured. Confidence intervals of averaged points are drawn as
error bars.</p></li>
<li><p><strong>Bar Chart with Matplotlib:</strong> Plots scalar results as a bar chart, with
Matplotlib. The bars can optionally be grouped. Individual bars in each group
can be stacked, or positioned in different ways. Confidence intervals are
displayed as error bars.</p></li>
<li><p><strong>Histogram Chart with Matplotlib:</strong> Plots histogram results with Matplotlib.
The drawing style can be filled or outline. Transformations to cumulative and
normalized forms are available.</p></li>
<li><p><strong>Histogram Chart from Vectors with Matplotlib:</strong> Plots histograms from vector
results with Matplotlib. The drawing style can be filled or outline.
Transformations to cumulative and normalized forms are available.</p></li>
</ul>
<p>Since Matplotlib has vastly more possibilities than the native plots,
there are some additional Matplotlib-based charts:</p>
<ul class="simple">
<li><p><strong>Box and Whiskers Chart (Matplotlib):</strong> A box and whiskers plot from
statistics or histograms. Shows the minimum, mean, maximum, and the 25th and
75th percentile marks (estimated from the standard deviation) of the results.</p></li>
<li><p><strong>Line Chart on Separate Axes with Matplotlib:</strong> Plots vector results as line
charts, with Matplotlib, each on its own axes. This is very similar to the
regular “Line Chart with Matplotlib” template; the only difference is that
every vector is drawn into its own separate coordinate system, arranged in a
column, all sharing their X axes. The default interpolation mode is determined
automatically from the result attributes. Many kinds of vector operations
(smoothing, accumulating, mathematical formulas, etc.) can be easily performed
on the vector data. Interpolation, markers, and line style can be configured.</p></li>
<li><p><strong>3D Chart (Scalar in the Function of Itervars):</strong> Plots a scalar result with
respect to two iteration variables as a 3D chart. Data points can be rendered
as bars, points, or a surface. Various color maps can be chosen.</p></li>
</ul>
<p>Generic charts, which can serve as a starting point for custom plots:</p>
<ul class="simple">
<li><p><strong>Generic Matplotlib Plot:</strong> An almost blank template using Matplotlib. It only
contains an example script, which you are expected to replace with your own
code.</p></li>
<li><p><strong>Generic Matplotlib X-Y Plot:</strong> An example line plot using Matplotlib. It only
contains an example script, which you are expected to replace with your own
code.</p></li>
<li><p><strong>Generic X-Y Plot:</strong> An example line plot using the native plot widget. It
only contains an example script, which you are expected to replace with your
own code.</p></li>
</ul>
<p>The configuration dialog is a little different for each chart type, but they are
structured similarly and there are a lot of similarities. The next sections detail
how to configure the charts.</p>
<p>Remember that it is straightforward to create new chart templates by customizing
existing charts (its chart script and/or the dialog pages) and saving them as a
chart template. See the <a class="reference internal" href="#ana-editing-chart-script"><span class="std std-ref">Editing the Chart Script</span></a>, <a class="reference internal" href="#ana-editing-dialog-pages"><span class="std std-ref">Editing Dialog Pages</span></a>,
and <a class="reference internal" href="#ana-custom-chart-templates"><span class="std std-ref">Custom Chart Templates</span></a> sections for details.</p>
</section>
<section id="defining-the-chart-input">
<h3>Defining the Chart Input</h3>
<p>Defining the input for the chart is the first step in the process of producing
the desired plot. It is normally done on the <span class="guilabel">Inputs</span> page of the
chart dialog.</p>
<p>The <em>filter expression</em> is the most prominent field on the <span class="guilabel">Inputs</span>
page. It selects from the results loaded into the analysis, that is, from the
contents of the result files selected on the <span class="guilabel">Input</span> page of the
editor. The filter expression can be as simple as <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">=~</span> <span class="pre">&quot;*.host[*].app[*]&quot;</span>
<span class="pre">AND</span> <span class="pre">name</span> <span class="pre">=~</span> <span class="pre">&quot;pkLatency:mean&quot;</span></code> for selecting the mean packet latencies from all
apps in the network, or can be composed of many more selectors combined with
<code class="docutils literal notranslate"><span class="pre">AND</span></code>, <code class="docutils literal notranslate"><span class="pre">OR</span></code>, and parentheses. The detailed syntax of the filter expression
is described in the section <a class="reference internal" href="#ana-filter-expression"><span class="std std-ref">Filter Expressions</span></a>.</p>
<p>The filter expression is normally used in a <code class="docutils literal notranslate"><span class="pre">results.get_vectors()</span></code>,
<code class="docutils literal notranslate"><span class="pre">results.get_scalars()</span></code>, or <code class="docutils literal notranslate"><span class="pre">results.get_statistics()</span></code> call in the chart
script. To see the result of the query in the <span class="guilabel">Console</span> view, add the
<code class="docutils literal notranslate"><span class="pre">print(df)</span></code> line after the call in the chart script (see “Editing the chart
script” section).</p>
<p>In charts working from vector input, the <span class="guilabel">Inputs</span> dialog page allows
specifying a crop interval and the possibility to leave out empty vectors from
the result. These options are implemented as additional arguments to
<code class="docutils literal notranslate"><span class="pre">results.get_vectors()</span></code>.</p>
<p>Charts that work from scalar input contain the <span class="guilabel">Include fields</span>
checkbox, that allows the filter expression to match various fields (min, max,
mean, stddev, etc.) of recorded statistics. (Use the <span class="guilabel">Show fields as
scalars</span> button on the <span class="guilabel">Browse Data</span> page to see them.) This is also
implemented as an additional argument to <code class="docutils literal notranslate"><span class="pre">results.get_scalars()</span></code>.</p>
<p>To include additional input, modify the Python script to add your own data. Use
cases: To use multiple filter expressions (and combining the results); to add
external reference data; to compute new scalars from vectors or other scalars as
input.</p>
<p>After executing a result query, most charts require additional processing before
the data can be visualized. Charts utilizing scalar data typically involve a
<em>pivoting</em> step, while those working with vector data may incorporate <em>vector
operations</em> such as summation, computing running averages, or window averages.
Details on pivoting and vector operations will be covered in subsequent
sections. However, we will first explore the syntax of the filter expression in
detail.</p>
</section>
<section id="filter-expressions">
<span id="ana-filter-expression"></span><h3>Filter Expressions</h3>
<p>Filter expressions are primarily used on the <span class="guilabel">Input</span> page of chart
dialogs for selecting simulation results as input for the chart. They can also
be used on the <span class="guilabel">Browse Data</span> editor page for filtering the table/tree
contents, and they also appear, in more generic forms, in other parts of the
IDE.</p>
<p>A filter expression is composed of terms that can be combined with the <code class="docutils literal notranslate"><span class="pre">AND</span></code>,
<code class="docutils literal notranslate"><span class="pre">OR</span></code>, <code class="docutils literal notranslate"><span class="pre">NOT</span></code> operators, and parentheses. A term filters for the value of some
property of the item and has the form <code class="docutils literal notranslate"><span class="pre">&lt;property&gt;</span> <span class="pre">=~</span> <span class="pre">&lt;pattern&gt;</span></code>, or simply
<code class="docutils literal notranslate"><span class="pre">&lt;pattern&gt;</span></code>. The latter is equivalent to <code class="docutils literal notranslate"><span class="pre">name</span> <span class="pre">=~</span> <span class="pre">&lt;pattern&gt;</span></code>.</p>
<p>A typical example is to select certain simulation results recorded by specific
modules. For example, the expression <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">=~</span> <span class="pre">&quot;**.app[*]&quot;</span> <span class="pre">AND</span> <span class="pre">name</span> <span class="pre">=~</span>
<span class="pre">&quot;pkRecvd*&quot;</span></code> selects results whose name begins with <code class="docutils literal notranslate"><span class="pre">pkRecvd</span></code> from modules
whose name is <code class="docutils literal notranslate"><span class="pre">app[0]</span></code>, <code class="docutils literal notranslate"><span class="pre">app[1]</span></code>, etc.</p>
<p>Patterns only need to be surrounded with quotes if they contain whitespace or
other characters that would cause a parsing ambiguity.</p>
<dl class="simple">
<dt>Here is the full list of available properties:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code>: Name of the result or item.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">module</span></code>: Full path of the result’s module.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">type</span></code>: Type of the item. The value is one of: <code class="docutils literal notranslate"><span class="pre">scalar</span></code>, <code class="docutils literal notranslate"><span class="pre">vector</span></code>, <code class="docutils literal notranslate"><span class="pre">parameter</span></code>, <code class="docutils literal notranslate"><span class="pre">histogram</span></code>, <code class="docutils literal notranslate"><span class="pre">statistics</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">isfield</span></code>: <code class="docutils literal notranslate"><span class="pre">true</span></code> if the item is a synthetic scalar that represents a field of a statistic or a vector, <code class="docutils literal notranslate"><span class="pre">false</span></code> if not.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">file</span></code>: File name of the result or item.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">run</span></code>: Unique run ID of the run that contains the result or item.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">runattr:&lt;name&gt;</span></code>: Run attribute of the run that contains the result or item. Example: <code class="docutils literal notranslate"><span class="pre">runattr:measurement</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">attr:&lt;name&gt;</span></code>: Attribute of the result. Example: <code class="docutils literal notranslate"><span class="pre">attr:unit</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">itervar:&lt;name&gt;</span></code>: Iteration variable of the run that contains the result or item. Example: <code class="docutils literal notranslate"><span class="pre">itervar:numHosts</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">config:&lt;key&gt;</span></code>: Configuration key of the run that contains the result or item. Example: <code class="docutils literal notranslate"><span class="pre">config:sim-time-limit</span></code>, <code class="docutils literal notranslate"><span class="pre">config:**.sendIaTime</span></code>.</p></li>
</ul>
</dd>
<dt>In the values, the match pattern may contain the following wildcards:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">?</span></code> matches any character except ‘.’</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">*</span></code> matches zero or more characters except ‘.’</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**</span></code> matches zero or more characters (any character)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{a-z}</span></code> matches a character in range a-z</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{^a-z}</span></code> matches a character not in the range a-z</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{32..255}</span></code> any number (i.e., sequence of digits) in the range 32..255 (e.g., <code class="docutils literal notranslate"><span class="pre">99</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[32..255]</span></code> any number in square brackets in the range 32..255 (e.g., <code class="docutils literal notranslate"><span class="pre">[99]</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">\\</span></code> takes away the special meaning of the subsequent character</p></li>
</ul>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Content Assist is available in text fields where you can enter filter
expressions. Press <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Ctrl</kbd>+<kbd class="kbd docutils literal notranslate">SPACE</kbd></kbd> to get a list of appropriate
suggestions at the cursor position.</p>
</div>
</section>
<section id="pivoting">
<h3>Pivoting</h3>
<p>Charts utilizing scalar data, such as bar charts and scatter plots, typically
involve a <em>pivoting</em> step, which converts the data from a linear, list-like
format into a more structured table format, which is essential for these types
of visualizations.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">results.get_scalars()</span></code> call produces a data frame with the essential
columns <code class="docutils literal notranslate"><span class="pre">module</span></code>, <code class="docutils literal notranslate"><span class="pre">name</span></code> (result name), and <code class="docutils literal notranslate"><span class="pre">value</span></code>, along with additional
columns for potential result attributes and various properties describing the
simulation run. After pivoting along the <code class="docutils literal notranslate"><span class="pre">module</span></code> and <code class="docutils literal notranslate"><span class="pre">name</span></code> columns, this
data is transformed so that each module becomes a row, each result name becomes
a column, and the values fill the cells at the intersection of these rows and
columns. If the data includes results from multiple simulations, the values are
averaged to provide a consolidated overview.</p>
</section>
<section id="vector-operations">
<h3>Vector Operations</h3>
<p>The charts that show vector results offer a selection of operations
to transform the data before plotting.</p>
<p>These can be added to the chart under the <span class="guilabel">Apply</span> or
<span class="guilabel">Compute</span> context menu items. Both ways of adding operations compute
new vectors from existing ones. The difference between them is that
<span class="guilabel">Apply</span> replaces the original data with the computation result, while
<span class="guilabel">Compute</span> keeps both.</p>
<p>Some operations have parameters that can be edited before adding them.</p>
<p>The operations are added to a field on the <span class="guilabel">Input</span> page of the chart
configuration dialog.</p>
<p>Most operations perform a fairly simple transformation on each individual
vector independently.</p>
<p>For example, see the screenshots illustrating the effects of the following
vector operations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">apply</span><span class="p">:</span><span class="nb">sum</span>
<span class="n">apply</span><span class="p">:</span><span class="n">diffquot</span>
<span class="n">apply</span><span class="p">:</span><span class="n">movingavg</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
<p>The operations <code class="docutils literal notranslate"><span class="pre">apply:sum</span></code>, <code class="docutils literal notranslate"><span class="pre">apply:diffquot</span></code>, and <code class="docutils literal notranslate"><span class="pre">apply:movingavg(alpha=0.05)</span></code>
transform vector data by computing cumulative sums, rate of change between
consecutive values, and applying an exponentially weighted moving average,
respectively.</p>
<figure class="align-default" id="id13">
<a class="reference internal image-reference" href="../_images/ANF-VectorOperations-1.png"><img alt="../_images/ANF-VectorOperations-1.png" src="../_images/ANF-VectorOperations-1.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 129 </span><span class="caption-text">Vector Operations - Before</span></p>
</figcaption>
</figure>
<figure class="align-default" id="id14">
<a class="reference internal image-reference" href="../_images/ANF-VectorOperations-2.png"><img alt="../_images/ANF-VectorOperations-2.png" src="../_images/ANF-VectorOperations-2.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 130 </span><span class="caption-text">Vector Operations - After</span></p>
</figcaption>
</figure>
<p>The list of available operations includes:</p>
<ul class="simple">
<li><p><cite>mean()</cite>: Computes the cumulative average of values up to each point.</p></li>
<li><p><cite>sum()</cite>: Calculates the cumulative sum of values up to each point.</p></li>
<li><p><cite>add(c)</cite>: Adds a specified constant to all values.</p></li>
<li><p><cite>compare(threshold, less=None, equal=None, greater=None)</cite>: Compares each value against a threshold and replaces it based on specified conditions.</p></li>
<li><p><cite>crop(t1, t2)</cite>: Discards values outside a specified time interval.</p></li>
<li><p><cite>difference()</cite>: Subtracts each value from its predecessor.</p></li>
<li><p><cite>diffquot()</cite>: Computes the rate of change between consecutive values.</p></li>
<li><p><cite>divide_by(a)</cite>: Divides all values by a constant.</p></li>
<li><p><cite>divtime()</cite>: Divides each value by its corresponding time.</p></li>
<li><p><cite>expression(expression, as_time=False)</cite>: Evaluates a Python expression for each value, optionally updating time instead of values.</p></li>
<li><p><cite>integrate(interpolation=”sample-hold”)</cite>: Integrates the series using the specified interpolation.</p></li>
<li><p><cite>lineartrend(a)</cite>: Adds a linear trend to the series.</p></li>
<li><p><cite>modulo(m)</cite>: Applies modulo operation to the series with a constant.</p></li>
<li><p><cite>movingavg(alpha)</cite>: Applies an exponentially weighted moving average to the series.</p></li>
<li><p><cite>multiply_by(a)</cite>: Multiplies all values by a constant.</p></li>
<li><p><cite>removerepeats()</cite>: Removes consecutive repeated values.</p></li>
<li><p><cite>slidingwinavg(window_size, min_samples=None)</cite>: Computes the average of values within a sliding window.</p></li>
<li><p><cite>subtractfirstval()</cite>: Subtracts the first value from all subsequent values.</p></li>
<li><p><cite>timeavg(interpolation)</cite>: Computes the average of values over time using the specified interpolation.</p></li>
<li><p><cite>timediff()</cite>: Calculates the time difference between consecutive values.</p></li>
<li><p><cite>timeshift(dt)</cite>: Shifts the time series by a constant.</p></li>
<li><p><cite>timedilation(c)</cite>: Scales the time series by a constant factor.</p></li>
<li><p><cite>timetoserial()</cite>: Converts time values to their sequential index.</p></li>
<li><p><cite>timewinavg(window_size=1)</cite>: Computes the average of values within a fixed time window.</p></li>
<li><p><cite>timewinthruput(window_size=1)</cite>: Calculates the throughput over a fixed time window.</p></li>
<li><p><cite>winavg(window_size=10)</cite>: Computes the average of values within each batch of a specified size.</p></li>
</ul>
<p>See a description of all built-in vector operations in the Simulation Manual.</p>
</section>
<section id="plot-options">
<h3>Plot Options</h3>
<p>The configuration dialogs for charts contain specific pages tailored to
customizing the plot:</p>
<ul class="simple">
<li><p>The <span class="guilabel">Plot</span> page allows setting the plot title, adjusting axis labels, setting
axis limits, configuring axis scales (linear or logarithmic), toggling and
configuring grid display, and managing legend display and placement.</p></li>
<li><p>The <span class="guilabel">Lines</span> page appears in line plots, and allows you to customize plot line
attributes such as style, color, and width, and marker characteristics
including type and size.</p></li>
<li><p>The <span class="guilabel">Bars</span> page appears with bar charts, and allows changing the baseline, the
bar placement (aligned, overlap, in-front, or stacked), and details like label
rotation.</p></li>
<li><p>The <span class="guilabel">Histogram</span> page appears in histogram plots, and allows the user to
configure histograms by setting a baseline, choosing between solid or outline
draw styles, normalizing data, displaying cumulative results, and managing
under/overflows.</p></li>
</ul>
<p>The majority of the settings mentioned are straightforward and intuitive;
however, there is an important aspect regarding how colors and markers are
determined in the plots. Unlike static configurations, the number of data items
represented in the plot is dynamic, varying based on the results retrieved by a
query. Consequently, colors and markers cannot be assigned directly to each
individual data point.</p>
<p>Instead, these visual attributes are managed through “cyclers,” which
systematically rotate through a predefined set of colors and markers. This
approach ensures an appealing visual representation regardless of the
number of data items displayed. To customize the sequence of colors and markers
used in Auto mode, you can adjust the cycle seed on the <span class="guilabel">Styling</span> page. This
allows for the modification of the appearance of plot elements dynamically,
accommodating the varying result sets returned by different queries.</p>
</section>
<section id="legend-labels">
<h3>Legend Labels</h3>
<p>The labels of data items in the legend are normally produced automatically,
making use of the properties that differ across the data items. (The properties
that are the same in all items are, on the other hand, used for producing the
chart title.) With automatic legend labels, the user is given the choice of
stating the preference between using result names instead of result titles, and
module display paths instead of module full paths. (The result title is the
content of the <code class="docutils literal notranslate"><span class="pre">title</span></code> attribute of the result. The display path is a variant
of the full path where, if available, the display names of modules are used
instead of the normal names; the display name is set using the <code class="docutils literal notranslate"><span class="pre">display-name</span></code>
configuration option.)</p>
<p>For those who require more detailed control, the Manual mode allows users to
define a custom format string for the legend labels. This string can include
placeholders like <code class="docutils literal notranslate"><span class="pre">$name</span></code>, <code class="docutils literal notranslate"><span class="pre">$title</span></code>, <code class="docutils literal notranslate"><span class="pre">$module</span></code>. These placeholders refer
to dataframe columns, so the exact list varies depending on the chart type and
the kind of simulation results. When in doubt, insert a <code class="docutils literal notranslate"><span class="pre">print(df)</span></code> statement
in the chart script and check the log in the Console.</p>
<p>The labels produced like that can be further tweaked using replacements. You can
input plain substrings or regular expressions to be replaced with the strings
you specify. Using this feature, you can achieve things like replacing
abbreviations with full terms, discarding unwanted parts, replacing module names with
more descriptive names, or adjusting separator/punctuation characters or spacing.
For example, the <code class="docutils literal notranslate"><span class="pre">/host\[(\d+)\]/Host</span> <span class="pre">\1/</span></code> regex replacement will turn strings
like <code class="docutils literal notranslate"><span class="pre">host[0]</span></code>, <code class="docutils literal notranslate"><span class="pre">host[1]</span></code>, etc. into <code class="docutils literal notranslate"><span class="pre">Host</span> <span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">Host</span> <span class="pre">1</span></code>, and so on.</p>
</section>
<section id="ordering">
<h3>Ordering</h3>
<p>Charts normally allow controlling the order of the data items (series) in
the plot. The ordering affects both the chart presentation and the legend,
enabling users to place important or related items together.</p>
<p>When exporting multiple charts, or when selecting the <span class="guilabel">Export Chart</span>
option for a single chart, a common export dialog is opened.</p>
<p>The order is defined via a list of regular expressions that are matched against
the legend labels of the items. The plot items will be ranked based on the index
of the regular expression the item first matches. Case-sensitive substring match
is done, so <code class="docutils literal notranslate"><span class="pre">^</span></code> and <code class="docutils literal notranslate"><span class="pre">$</span></code> should be used to match the beginning and end of the
label, respectively. For example, the regex list (<code class="docutils literal notranslate"><span class="pre">router</span></code>, <code class="docutils literal notranslate"><span class="pre">host</span></code>) will
place all items whose label contains the “router” string in front of items that
contain “host”, and items that contain neither will follow. The list (<code class="docutils literal notranslate"><span class="pre">^B</span></code>,
<code class="docutils literal notranslate"><span class="pre">^A</span></code>) will move items starting with capital “B” to the top, followed by items
starting with capital “A”, and the rest below.</p>
<p>There are two regular expression lists, defining a primary and secondary
ordering. The primary ordering takes precedence, and the secondary ordering is
used to further refine the arrangement of items that are equivalently ranked in
the primary order.</p>
<p>A further checkbox allows users to enable or disable alphabetical sorting as a
tertiary ordering mechanism. This is useful when two items do not match any of
the specified regular expressions, ensuring that there is still a consistent
rule to fall back on for their ordering. When activated, this setting ensures
that after considering the regex-based rankings, items will be alphabetically
ordered.</p>
</section>
<section id="styling">
<h3>Styling</h3>
<p>The <span class="guilabel">Styling</span> page of the dialog allows setting a number of options that affect
the presentation of the plot.</p>
<p>For Matplotlib-based charts, you can select the plot style. This is the same that you can
select in plain Matplotlib using the <code class="docutils literal notranslate"><span class="pre">matplotlib.style.use(style)</span></code> command.
There are a number of built-in styles, and you can add new styles by installing
packages like <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> or <code class="docutils literal notranslate"><span class="pre">prettyplotlib</span></code>.</p>
<p>You can set the background colors, some legend display options, etc.</p>
<p>You can set the seed used for the color and marker cyclers. Experimenting with
different seeds allows you to choose a new set of colors/markers for the plot if
you do not like the default ones. If you want to have even more control over
the colors and markers, you can define your own cycler and enter it as
properties on the <span class="guilabel">Advanced</span> page of the dialog.</p>
<p>The <span class="guilabel">Advanced</span> page enables even more fine-grained customization by allowing users
to directly set visual plot properties that are not explicitly configurable in
the dialog. For Matplotlib charts, you can enter settings in the format known as
“rcParams” in Matplotlib terminology. Native plots have their own visual
properties; content assistance in the dialog will help discover them. Native
plots also allow directly setting colors for individual items via properties.</p>
</section>
</section>
<section id="editing-the-chart-script">
<span id="ana-editing-chart-script"></span><h2>Editing the Chart Script</h2>
<p>All charts are powered by Python scripts, which take their configuration
settings from properties that can be edited in the <span class="guilabel">Chart
Configuration</span> dialog. All of these elements are under your full control so that
you can create exactly the plots that you need for your analysis: you can edit
the chart script, you can edit the properties using the configuration dialog,
and you can also modify/tweak the configuration dialog itself to add input
fields for extra properties, for example. Each chart has its own copy of
everything (the chart script, properties and config dialog pages), so modifying
one chart will not affect other similar charts.</p>
<section id="editing">
<h3>Editing</h3>
<p>To see or edit the chart’s Python script, click the <span class="guilabel">Show Code Editor</span>
button on the toolbar of an open chart. With the code editor open, you are free
to make any changes to the chart’s script.</p>
<p>The integrated editor is that of the PyDev project. It provides syntax
highlighting, code navigation (go to definition, etc.), helpful tooltips (using
docstrings), and content assist (completion suggestions).</p>
<figure class="align-default" id="id15">
<img alt="../_images/ANF-ChartScriptEditor.png" src="../_images/ANF-ChartScriptEditor.png" />
<figcaption>
<p><span class="caption-number">Fig. 131 </span><span class="caption-text">Chart Script Editor</span></p>
</figcaption>
</figure>
</section>
<section id="refreshing-the-chart">
<h3>Refreshing the Chart</h3>
<p>Normally, the chart script is automatically re-executed with some delay after
each edit. This functionality can be enabled/disabled using the
<span class="guilabel">Automatic Refresh</span> button on the chart page toolbar. Independent of
the auto-refresh state, you can always trigger a manual refresh (re-execution of
chart script) by pressing the <span class="guilabel">Refresh</span> on the toolbar. If the chart
script execution takes too long, you can abort it by clicking the
<span class="guilabel">Kill Python Process of the Chart</span> button on the toolbar.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The viewport (zoom/pan state) is usually preserved after refresh. If the area
occupied by the displayed data changes significantly for some reason, it is
possible that you will see an empty plot after the refresh, simply because
valuable content now falls outside the viewport. Push the <span class="guilabel">Home</span>
icon on the toolbar in these cases to bring all plotted elements into view.</p>
</div>
</section>
<section id="console-output">
<h3>Console Output</h3>
<p>The console output of the script, i.e. text written to the <em>stdout</em> and <em>stderr</em>
streams, is displayed in the <span class="guilabel">Console</span> view. Each chart has a console
of its own in the view, which is activated when switching to the chart’s page in
the editor. Text written to the standard error stream appears in red. You can
write to the console using Python’s <code class="docutils literal notranslate"><span class="pre">print()</span></code> statement. Notably,
<code class="docutils literal notranslate"><span class="pre">print(df)</span></code> is a very useful line that you’ll probably end up using quite often.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Even though PyDev offers a variety of tools for debugging Python scripts,
these unfortunately don’t work on chart scripts. Limited debugging can be
performed using print statements, throwing exceptions, and dumping stack traces,
which is usually enough. If you really need debugging to get a piece of code
working, one way is to factor out the code to be able to run independently,
and use an external debugger (or the IDE’s debugger) on the resulting <code class="docutils literal notranslate"><span class="pre">.py</span></code> file.</p>
</div>
</section>
<section id="errors">
<h3>Errors</h3>
<p>Errors are marked in the source code with a red squiggle and a sidebar icon.
Hover over them to see a tooltip describing the error. The errors are also
entered into the <span class="guilabel">Problems</span> view. Double-clicking these problem
entries will reveal the line in the code editor where the error came from.
Errors marked this way include Python syntax errors, and runtime errors that
manifest themselves in the form of Python exceptions. For exceptions, the
stack trace is printed in the <span class="guilabel">Console</span> view.</p>
<figure class="align-default" id="id16">
<img alt="../_images/ANF-ChartScriptError.png" src="../_images/ANF-ChartScriptError.png" />
<figcaption>
<p><span class="caption-number">Fig. 132 </span><span class="caption-text">A Python error is marked on the GUI</span></p>
</figcaption>
</figure>
</section>
</section>
<section id="editing-dialog-pages">
<span id="ana-editing-dialog-pages"></span><h2>Editing Dialog Pages</h2>
<section id="the-edit-pages-dialog">
<h3>The Edit Pages Dialog</h3>
<p>If you need to add support for new configuration properties to the chart, you
will need to edit the forms on the <span class="guilabel">Configure Chart</span> dialog. Pages
(tabs) in the configuration dialog are represented as XSWT forms. To see or edit
the pages and forms within, click the <span class="guilabel">Edit Dialog Pages</span> button on
the property editor dialog.</p>
<p>The action will bring up the <span class="guilabel">Edit Chart Dialog Pages</span> dialog, which
lets you edit the forms that make up the configuration dialog of the chart.
You can add, remove, reorder, and rename tabs, and you can edit the XSWT form
on each tab. A preview of the edited form is also shown.</p>
</section>
<section id="xswt-page-descriptions">
<h3>XSWT Page Descriptions</h3>
<p>XSWT is an XML-based UI description language for SWT, the widget toolkit
of Eclipse on which the OMNeT++ IDE is based. The content of XSWT files
closely mirrors SWT widget trees.</p>
<figure class="align-default" id="id17">
<img alt="../_images/ANF-EditChartPages.png" src="../_images/ANF-EditChartPages.png" />
<figcaption>
<p><span class="caption-number">Fig. 133 </span><span class="caption-text">Editing Chart Properties Editor Pages</span></p>
</figcaption>
</figure>
<p>The <span class="guilabel">New Page</span> in the dialog brings up a mini wizard, which can create
a full-fledged XSWT page from a shorthand notation of its content provided by
you.</p>
<figure class="align-default" id="id18">
<a class="reference internal image-reference" href="../_images/ANF-NewDialogPage.png"><img alt="../_images/ANF-NewDialogPage.png" src="../_images/ANF-NewDialogPage.png" style="width: 60%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 134 </span><span class="caption-text">The Creating a New Dialog Page From a Shorthand Notation</span></p>
</figcaption>
</figure>
<p>Some XML attributes in the XSWT source have special roles:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x:id</span></code> binds the contents of the widget to a chart property. For example,
an edit control defined as <code class="docutils literal notranslate"><span class="pre">&lt;text</span> <span class="pre">x:id=&quot;title&quot;&gt;</span></code> edits the <code class="docutils literal notranslate"><span class="pre">title</span></code> chart
property, which can be accessed as <code class="docutils literal notranslate"><span class="pre">props[&quot;title&quot;]</span></code> in the chart script.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x:id.default</span></code> provides a default value for the chart property named in the
<code class="docutils literal notranslate"><span class="pre">x:id</span></code> attribute.</p></li>
<li><p>Further <code class="docutils literal notranslate"><span class="pre">x:id.*</span></code> attributes are also used, e.g., <code class="docutils literal notranslate"><span class="pre">x:id.contentAssist</span></code>
defines the kind of content assist requested for the edit control, or
<code class="docutils literal notranslate"><span class="pre">x:id.isEnabler</span></code> denotes a checkbox as the enabler of the widget group
that contains it.</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The easiest way to add a new field to a page is to look at other pages (or
other charts’ pages) and copy/paste from them.</p>
</div>
</section>
</section>
<section id="chart-programming">
<span id="ana-chart-programming"></span><h2>Chart Programming</h2>
<p>Data processing in chart scripts is based on the NumPy and Pandas packages, with
some modules provided by OMNeT++.</p>
<section id="python-modules">
<h3>Python Modules</h3>
<p>The chart scripts can access some functionality of the IDE through a couple of
modules under the <code class="docutils literal notranslate"><span class="pre">omnetpp.scave</span></code> package. These include: <code class="docutils literal notranslate"><span class="pre">chart</span></code>,
<code class="docutils literal notranslate"><span class="pre">results</span></code>, <code class="docutils literal notranslate"><span class="pre">ideplot</span></code>, <code class="docutils literal notranslate"><span class="pre">vectorops</span></code>, and <code class="docutils literal notranslate"><span class="pre">utils</span></code>. The complete API of
these modules is described in the Simulation Manual.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">chart</span></code> module exposes information about the chart object (as part of the
analysis, and visible on the <span class="guilabel">Charts</span> page), most importantly its set
of properties but also its name and what type of chart it is.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">results</span></code> module provides access to the set of result items (and
corresponding metadata) currently loaded in the analysis in the IDE. This data
is accessible through a set of query functions, each taking a filter expression,
and returning a Pandas DataFrame.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ideplot</span></code> module is the interface for displaying plots using the IDE’s
native (non-Matplotlib) plotting widgets from chart scripts. The API is
intentionally very close to <code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot</span></code>. When <code class="docutils literal notranslate"><span class="pre">ideplot</span></code> is used
outside the context of a native plotting widget (such as during the run of
<code class="docutils literal notranslate"><span class="pre">opp_charttool</span></code>, or in the IDE during image export), the functions are
emulated with Matplotlib.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">vectorops</span></code> module contains the implementations of the built-in vector
operations.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">utils</span></code> module is a collection of utility functions for processing and
plotting data. Most chart scripts heavily rely on <code class="docutils literal notranslate"><span class="pre">utils</span></code>.</p>
<p>Additionally, the well-known <code class="docutils literal notranslate"><span class="pre">numpy</span></code>, <code class="docutils literal notranslate"><span class="pre">pandas</span></code>, <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>, and
sometimes the <code class="docutils literal notranslate"><span class="pre">scipy</span></code> and <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> packages are often utilized. All other
packages installed on the system are also fully available.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>See the Simulation Manual for details on the OMNeT++ result analysis Python
modules. It contains a section on chart programming, and an API reference in
the Appendix.</p>
</div>
</section>
<section id="tips-and-tricks">
<h3>Tips and Tricks</h3>
<p>This section is a collection of tips for use cases that might come up often when
working with charts, especially when editing their scripts.</p>
<section id="sharing-code-among-charts">
<h4>Sharing Code Among Charts</h4>
<p>For future releases, we are planning to support “snippets” as part of the
analysis file, as a means of sharing code among charts. Until that feature is
implemented, a workaround is to put shared code in <code class="docutils literal notranslate"><span class="pre">.py</span></code> files. These scripts
can be imported as modules. They will be looked for in the folder containing the
<code class="docutils literal notranslate"><span class="pre">.anf</span></code> file and in the <code class="docutils literal notranslate"><span class="pre">python</span></code> folders of the containing project and all
of its referenced projects. Chart scripts can import these files as modules and
thereby use the functionality they provide. This also makes it possible to use
external code editors for parts of your code.</p>
</section>
<section id="adding-extra-data-items-to-the-plot">
<h4>Adding Extra Data Items to the Plot</h4>
<p>It’s possible to add new data items to the queried results before plotting.
These can be computed from existing items or synthesized from a formula.
Example uses:</p>
<ul>
<li><p>Computing derived results:</p>
<p><code class="docutils literal notranslate"><span class="pre">df[&quot;bitrate&quot;]</span> <span class="pre">=</span> <span class="pre">df[&quot;txBytes&quot;]</span> <span class="pre">/</span> <span class="pre">df[&quot;sim-time-limit&quot;]</span></code></p>
</li>
<li><p>Adding analytical references, like theoretical values in an ideal scenario:</p>
<p><code class="docutils literal notranslate"><span class="pre">df[&quot;analytical&quot;]</span> <span class="pre">=</span>&#160; <span class="pre">df[&quot;p&quot;]</span> <span class="pre">*</span> <span class="pre">(1</span> <span class="pre">-</span> <span class="pre">df[&quot;p&quot;])</span> <span class="pre">**</span> <span class="pre">(df[&quot;N&quot;]-1)</span></code></p>
</li>
<li><p>Summarizing results:</p>
<p><code class="docutils literal notranslate"><span class="pre">df[&quot;mean&quot;]</span> <span class="pre">=</span> <span class="pre">df[&quot;vecvalues&quot;].map(np.mean)</span></code></p>
</li>
</ul>
</section>
<section id="simplifying-complex-queries">
<h4>Simplifying Complex Queries</h4>
<p>Instead of coming up with an elaborate filter expression, it is sometimes more
straightforward to query results multiple times within a script and combine
them with <code class="docutils literal notranslate"><span class="pre">pd.concat</span></code>, <code class="docutils literal notranslate"><span class="pre">pd.join</span></code>, or <code class="docutils literal notranslate"><span class="pre">pd.merge</span></code>. Other functions like
<code class="docutils literal notranslate"><span class="pre">pf.pivot</span></code> and <code class="docutils literal notranslate"><span class="pre">pd.pivot_table</span></code> are also often useful in these cases.</p>
</section>
<section id="defining-new-vector-operations">
<h4>Defining New Vector Operations</h4>
<p>You can define your own vector operations by injecting them into the
<code class="docutils literal notranslate"><span class="pre">vectorops</span></code> module, even if this injection is done in an external module
(<code class="docutils literal notranslate"><span class="pre">.py</span></code> file imported from the directory of the <code class="docutils literal notranslate"><span class="pre">.anf</span></code> file).</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">omnetpp.scave</span> <span class="kn">import</span> <span class="n">vectorops</span>
<span class="k">def</span> <span class="nf">myoperation</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
   <span class="n">row</span><span class="p">[</span><span class="s2">&quot;vecvalue&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;vecvalue&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">sigma</span>
   <span class="k">return</span> <span class="n">row</span>
<span class="n">vectorops</span><span class="o">.</span><span class="n">myoperation</span> <span class="o">=</span> <span class="n">myoperation</span>
</pre></div>
</div>
<p>After injection, use it like any other vector operation, on the
<span class="guilabel">Input</span> page of Line Charts for example: <code class="docutils literal notranslate"><span class="pre">apply:</span>
<span class="pre">myoperation(sigma=4)</span></code></p>
</section>
<section id="customized-export">
<h4>Customized Export</h4>
<p>If the built-in image/data exporting facilities are not sufficient for your use
case, you can always add your export code, either by manually <code class="docutils literal notranslate"><span class="pre">open()</span></code>-ing
a file or by utilizing a data exporter library/function of your liking.
Functions such as <code class="docutils literal notranslate"><span class="pre">plt.savefig()</span></code> and <code class="docutils literal notranslate"><span class="pre">df.to_*()</span></code> can be useful for this.</p>
</section>
<section id="caching-the-result-of-expensive-operations">
<h4>Caching the Result of Expensive Operations</h4>
<p>Since the entire chart script is executed on every chart refresh, even if only a
visual property has changed, it can sometimes help to cache the result of some
expensive data querying or processing procedure in the script. And because every
execution is in a fresh Python process, caching can only really be done on the
disk.</p>
<p>There are existing packages that can help you with this, such as <code class="docutils literal notranslate"><span class="pre">diskcache</span></code>,
<code class="docutils literal notranslate"><span class="pre">cache.py</span></code>, or <code class="docutils literal notranslate"><span class="pre">memozo</span></code>. (Note that caching the result of a function call is
often called <em>memoization</em>; using that term in online searches may give you
additional insight.)</p>
<p>If the sequence of operations whose result is cached includes simulation result
querying (<code class="docutils literal notranslate"><span class="pre">results.get_scalars()</span></code>, etc.), it is important to invalidate
(clear) the cache whenever there is a change in the loaded result files. The
change can be detected by calling the <code class="docutils literal notranslate"><span class="pre">results.get_serial()</span></code> function, which
returns an integer that is incremented every time a result file is loaded,
unloaded, or reloaded.</p>
</section>
<section id="arbitrary-plot-types">
<h4>Arbitrary Plot Types</h4>
<p>In charts using Matplotlib, the whole range of its functionality is available:</p>
<ul class="simple">
<li><p>Arbitrary plots can be drawn (heatmaps, violin plots, geographical maps, 3D curves, etc.)</p></li>
<li><p>Advanced functionality like mouse event handlers, graphical effects, animations, and widgets all work</p></li>
<li><p>It’s also possible to just add small customizations, like annotations</p></li>
<li><p>Any extension library on top of Matplotlib can be used, such as: <em>seaborn</em>, <em>ggplot</em>, <em>holoviews</em>, <em>plotnine</em>, <em>cartopy</em>, <em>geoplot</em></p></li>
<li><p>The built-in plotting capability of Pandas DataFrames (under <code class="docutils literal notranslate"><span class="pre">df.plot</span></code>) works too</p></li>
</ul>
</section>
<section id="per-item-styling-on-native-plots">
<h4>Per-Item Styling on Native Plots</h4>
<p>For native plots, properties affecting individual data items can be specified
with the following additional syntax: <code class="docutils literal notranslate"><span class="pre">&lt;propertyname&gt;/&lt;itemkey&gt;</span></code>. Unless
overridden manually, the data item keys are sequentially increasing integers,
starting with <code class="docutils literal notranslate"><span class="pre">1</span></code>. For example, adding the following line on the Advanced tab
in the property editor dialog of a line chart will set the color of the second
line (or of the line identified with the key <code class="docutils literal notranslate"><span class="pre">2</span></code>) to red.</p>
<p><code class="docutils literal notranslate"><span class="pre">Line.Color/2</span> <span class="pre">:</span> <span class="pre">#FF0000</span></code></p>
</section>
</section>
</section>
<section id="custom-chart-templates">
<span id="ana-custom-chart-templates"></span><h2>Custom Chart Templates</h2>
<p>When charts are created, they are instantiated from a template. The list of
available chart templates can be browsed in the template gallery dialog,
available from the <span class="guilabel">Charts</span> page as <span class="guilabel">New Chart</span> and from
the <span class="guilabel">Browse Data</span> page as <span class="guilabel">Choose from Template Gallery</span>.
The dialog shows some properties (chart type, accepted result types), a
description, and often also sample images for each one.</p>
<p>The IDE contains a number of built-in chart templates, but the user can add
their own too. Custom chart templates live in the <code class="docutils literal notranslate"><span class="pre">charttemplates</span></code> folder of
every project and are available in analyses in the same project and all projects
that depend on it.</p>
<section id="exporting-a-chart-as-template">
<h3>Exporting a Chart as Template</h3>
<p>The easiest way of creating a custom chart template is by customizing a chart,
then saving it as a template. The <span class="guilabel">Save as Template</span> option in the
chart’s context menu writes the contents of the given chart into the
<code class="docutils literal notranslate"><span class="pre">charttemplates</span></code> directory of the project.</p>
<figure class="align-default" id="id19">
<a class="reference internal image-reference" href="../_images/ANF-ExportedChartTemplate.png"><img alt="../_images/ANF-ExportedChartTemplate.png" src="../_images/ANF-ExportedChartTemplate.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 135 </span><span class="caption-text">An Exported Chart Template</span></p>
</figcaption>
</figure>
<p>You may want to tweak some properties (e.g., the descriptive name) of the saved
chart template before use, but regardless, the new chart template is immediately
available for use.</p>
</section>
<section id="parts-of-a-chart-template">
<h3>Parts of a Chart Template</h3>
<p>A chart template consists of several parts, describing the initial contents of
charts created from it: what kind of drawing widget it needs (Matplotlib or one
of the native plot widgets), what script it executes, how its configuration dialog
looks like, what types of result items it can process/show, and which icon
should be used for it.</p>
<p>Namely, there are several files:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;name&gt;.properties</span></code>: This is the main file. It defines the name and other
attributes of the chart template and references all other files by name. The
syntax is Java property file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;name&gt;.py</span></code>: The Python file that contains the chart script.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">*.xswt</span></code>: The dialog pages.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Scripts and dialog pages can be shared by multiple chart templates.</p>
</div>
<p>Notable keys in the properties file:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">id</span></code>: Internal identifier</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code>: Descriptive name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">type</span></code>: <code class="docutils literal notranslate"><span class="pre">MATPLOTLIB</span></code>, or one of <code class="docutils literal notranslate"><span class="pre">LINE</span></code>, <code class="docutils literal notranslate"><span class="pre">BAR</span></code>, and <code class="docutils literal notranslate"><span class="pre">HISTOGRAM</span></code> for native plots</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scriptFile</span></code>: The chart script Python file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">icon</span></code>: Icon file, e.g. in PNG format</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">resultTypes</span></code>: One or more of <code class="docutils literal notranslate"><span class="pre">scalar</span></code>, <code class="docutils literal notranslate"><span class="pre">vector</span></code>, <code class="docutils literal notranslate"><span class="pre">parameter</span></code>, <code class="docutils literal notranslate"><span class="pre">histogram</span></code>, and <code class="docutils literal notranslate"><span class="pre">statistics</span></code>, separated by commas</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">description</span></code>: Long description of the chart in HTML format</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dialogPage.&lt;n&gt;.id</span></code>: Internal identifier of the nth dialog page</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dialogPage.&lt;n&gt;.label</span></code>: Label of the tab of the nth dialog page</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dialogPage.&lt;n&gt;.xswtFile</span></code>: XSWT file of the nth dialog page</p></li>
</ul>
</section>
</section>
<section id="under-the-hood">
<span id="ana-under-the-hood"></span><h2>Under the Hood</h2>
<p>This section details the internal workings of the Python integration in the
Analysis Tool. Its contents are not directly useful for most users, only for
those who are curious about the technicalities or want to troubleshoot an issue.</p>
<p>Chart scripts are executed by separate Python processes, launched from the
<code class="docutils literal notranslate"><span class="pre">python3[.exe]</span></code> found in <code class="docutils literal notranslate"><span class="pre">$PATH</span></code>. This decision was made so that a rogue
chart script can’t make the entire IDE unresponsive or crash it. Also, it’s
possible to put resource or permission constraints on these processes without
hindering the IDE itself, and they can be killed at any time with no major
consequences to the rest of the Analysis Tool - for example, in the event of a
deadlock or thrashing.</p>
<p>These processes are ephemeral, and a fresh one is used for each refresh, so no
interpreter state is preserved across executions. A small number of processes
are kept pre-spawned in a pool, so they can be put to use quickly when needed.</p>
<p>If you wish to utilize virtual environments, start the entire IDE from a shell
in which the environment to use has been activated. This way, the spawned Python
interpreter processes will also run in that environment.</p>
<p>The level of flexibility offered by this arbitrary scripting unfortunately comes
with its own dangers too. Note that the scripts running in charts have full
access to everything on your computer without any sandboxing, so they can
read/write/delete files, open graphical windows, make network connections,
utilize any hardware resources, etc.! Because of this, make sure to only ever
open analysis files from sources you trust! (Or open files from untrusted
sources only on systems that are not critical.)</p>
<p>Communication between the Eclipse IDE and the spawned Python processes is done
via the Py4J project, through an ordinary network (TCP) socket.</p>
<p>To avoid the CPU and RAM inefficiencies caused by the string-based nature of the
Py4J protocol, bulk data is transferred in shared memory (POSIX SHM or unnamed
file mappings on Windows) instead of the socket. Without this, binary data would
have to be base64 encoded, then represented as UTF-16, which would be about 3x
the size on top of the original content, which is already present in both
processes. Data passed this way includes any queried results (in pickle format),
and in the other direction, the data to plot on native plot widgets, or the raw pixel
data rendered by Matplotlib.</p>
<p>Many other kinds of information, like GUI events or smaller pieces of data (like
chart properties) are passed through the Py4J socket as regular function call
parameters.</p>
</section>
</section>


          </div>
          
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;1992-2021, András Varga and OpenSim Ltd..
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/userguide/result-analysis.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>